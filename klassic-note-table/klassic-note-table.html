<!DOCTYPE html>
<html lang="en-SG">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'/>
	<script src="p5.js"></script>
    <title>Klassic Note Table</title>
</head>
<style>

</style>
<body>
    <h1>Klassic Note Table</h1>
    <p style="text-align: center;"><a href="../index.html">Back</a></p>
	<div id="table-sort-module">
		<div id="search-box">	
			<input id="dbInput" type="text" placeholder="search by song title" title="search"/>
			<input id="dbSubmit" type="submit" onclick="searchFunction()" placeholder="submit" title="submit"/>
		</div>
		<div id="table-box">
			<table id="dbTable">
				<!-- <tr class="header">
					<th style="width:auto;">Title</th>
					<th style="width:auto;">Artist</th>
					<th style="width:auto;">Commisioner</th>
					<th style="width:auto;">Completed</th>
				</tr>
				<tr>
					<td>The Annunciation</td>
					<td>Fra Angelico</td>
					<td>Cosimo de' Medici</td>
					<td>1446</td>
				</tr>
				<tr>
					<td>The Klassic</td>
					<td>The Angelica</td>
					<td>Cosimo Merci</td>
					<td>1448</td>
				</tr> -->
			</table>
		</div>
	</div>
</body>
<script>
document.getElementById('dbInput').addEventListener("keyup", function(event) {
  // Number 13 is the "Enter" key on the keyboard
  if (event.keyCode === 13) {
    // Cancel the default action, if needed
    event.preventDefault();
    // Trigger the button element with a click
    document.getElementById("dbSubmit").click();
  }
});
function searchFunction() {
	// Declare starting variables 
	var filter = document.getElementById("dbInput").value.toUpperCase();
	var table = document.getElementById("dbTable");
	var trs = table.tBodies[0].getElementsByTagName("tr");
	// Loop through rows
	for (var i = 1; i < trs.length; i++) {
		// Define the cells
		var tds = trs[i].getElementsByTagName("td");
		// hide the row
		trs[i].style.display = "none";
		// loop through cell columns
		for (var i2 = 0; i2 < tds.length; i2++) {
			// if there's a match AND based on column
			if (tds[i2].innerHTML.toUpperCase().indexOf(filter) > -1 && i2 == 6) {
			// show the row
			trs[i].style.display = "";
			// skip to the next row
			continue;
			}
		}
	}
}

//-- p5.js EXAMPLE --//
// Given the following CSV file called "klassic-note-database-song-table.csv"
// located in the project's root folder

let table;

function preload() {
  //my table is comma separated value "csv"
  //and has a header specifying the columns labels
  table = loadTable('https://knneo.github.io/klassic-note-table/klassic-note-database-song-table.csv', 'csv');
  //the file can be remote
  //table = loadTable("http://p5js.org/reference/assets/mammals.csv",
  //                  "csv", "header");
}

function setup() {
  //count the columns
  print(table.getRowCount() + ' total rows in table');
  print(table.getColumnCount() + ' total columns in table');

  //cycle through the table
  let tableArray = table.getArray();
  let tableHTML;
  for (let i = 0; i < tableArray.length; i++) {
    if(i > 0) {
	tableHTML += '<tr>';
	for(let j = 0; j < tableArray[i].length; j++) {
	tableHTML += '<td>' + tableArray[i][j] + '</td>';
	}
	tableHTML += '</tr>';
	continue;
	}
	//header
	tableHTML = '<tr class="header">';
	for(let j = 0; j < tableArray[i].length; j++) {
	tableHTML += '<td>' + tableArray[i][j] + '</td>';
	}
	tableHTML += '</tr>';
  }
  //assign
  document.getElementById("dbTable").innerHTML = tableHTML;
}
</script>
</html>
